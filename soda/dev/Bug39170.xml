
<soda>
    <puts text="--------Bug 39170 Started--------" />
    <csv file="tests/csvs/users.csv" var="user">
        <script file="tests/modules/lib/login.xml" />
    </csv>
    
    <!-- add "created by" filter -->
    <browser
        url="{@global.url}?module=ModuleBuilder&action=index&type=studio#mbContent=module%3DModuleBuilder%26action%3DeditLayout%26view%3Ddashletsearch%26view_module%3DTasks"
        assertPage="false" />
    <wait timeout="10" condition="true">
        <ul id="ul0" />
    </wait>
    <javascript addUtils="true">
        var start = YAHOO.util.Selector.query("li#subslot8")[0];
        var end = YAHOO.util.Selector.query("li#topslot0")[0];
        SUGAR.soda.fakeDrag(start, end);
    </javascript>
    <button name="savebtn" />

    <!-- Go to home page -->
    <browser
        url="{@global.url}?module=Home&action=index"
        assertPage="false" />
    
    <!-- Add dashlet and go to preferences-->
    <javascript>
        SUGAR.mySugar.addDashlet('MyTasksDashlet', 'module', 'Tasks');
        YAHOO.util.Selector.query("div.dashletToolSet > a")[0].onclick();
    </javascript>

    <wait timeout="3" />

    <!-- Asserts -->
    <browser assertnot="Not Implemented" />
    <browser assertnot="There was an error handling this request" />
    <browser assert="Created By" />

    <!-- restore defaults -->
    <puts text="Restoring ..." />
    <browser
        url="{@global.url}?module=ModuleBuilder&action=index&type=studio#mbContent=module%3DModuleBuilder%26action%3DeditLayout%26view%3Ddashletsearch%26view_module%3DTasks"
        assertPage="false" />
    <wait timeout="10" />
    <javascript>
        ModuleBuilder.history.browse("Tasks", "dashletsearch");
    </javascript>
    <wait timeout="5" />
    <puts text="Restore to default (usually)" />
    <javascript>
        var buttons = YAHOO.util.Selector.query("div#histWindow input[type=button]");
        buttons[buttons.length - 1].onclick();
    </javascript>
    <button name="savebtn" />

    <puts text="--------Bug 39170 Finished--------" />
</soda>
