
<soda>
	<!--
		Create opportunities_Verify that a related opportunity can be full form created from contact detail view
	-->
	<puts text="Test: Contacts_4357.xml starting." />


	<!--Create contact record & task subpanel-->
	<script file="{@global.scriptsdir}/modules/lib/Account_Create_Lib.xml" />
	<script file="{@global.scriptsdir}/modules/lib/Contact_Create_Lib.xml" />

	<!--goto Opportunities subpanel & Create opportunity"-->
	<div id="list_subpanel_opportunities">
		<button id="opportunities_contacts_create_button" />
	</div>


	<!--Fill all required fields-->
	<csv file="{@global.scriptsdir}/modules/lib/Opp_Create_Lib.csv" var="opp_record">
		<!--goto Opportunities subpanel & Create opportunity"-->
		<div id="list_subpanel_opportunities">
			<button id="opportunities_contacts_create_button" />
		</div>

		<!--Click the full form button-->
		<button id="Opportunities_subpanel_full_form_button" />
		<wait timeout="3" />

		<textfield id="name" set="{@opp_record.name} {@user.name} {@stamp}" /> 
		<textfield id="amount" set="{@opp_record.amount}" /> 
		<textfield id="probability" set="{@opp_record.probability}" /> 
		<textfield id="date_closed" set="{@opp_record.date_closed}" /> 
		<textfield id="next_step" set="{@opp_record.next_step}" />
		<textfield id="description" set="{@opp_record.description}" />
		<select id="opportunity_type" set="{@opp_record.opportunity_type}" />
		<select id="lead_source" set="{@opp_record.lead_source}" />
		<select name="currency_id" set="{@opp_record.currency_id}" />
		<select id="sales_stage" set="{@opp_record.sales_stage}" />

		<!--Account Select-->
		<button id="btn_account_name" />
		<browser assert="Account Search" />
		<textfield id="name_advanced" set="{@pre_account_name}" /> 
		<button value="Search" />
		<link text="{@pre_account_name}" />

		<button value="Save" />

		<!--Save key info-->
		<var var="Contacts_4357_Opp_name" set="{@opp_record.name} {@user.name} {@stamp}" />

		<div id="list_subpanel_opportunities">
			<table class="list view">
				<link text="{@Contacts_4357_Opp_name}" click="false" exist="true"/>
			</table>
		</div>
	</csv>
	<wait timeout="2"/>

	<!--Delete related record-->
	<script file="{@global.scriptsdir}/modules/lib/Contact_Delete_Lib.xml" />
	<script file="{@global.scriptsdir}/modules/lib/Account_Delete_Lib.xml" />
	<script file="{@global.scriptsdir}/modules/lib/Opp_Delete_Lib.xml" />
	<puts text="Test: Contacts_4357.xml finished." />
</soda>
